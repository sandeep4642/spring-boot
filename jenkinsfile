@Library('jenkins-shared-library')_

pipeline {
    agent any


environment {
    registry = "sandeep"
    registryrepo = "/sandeep-springboot/spring-boot"
    dockerfile = "Dockerfile"
    imageURI =  "${registry}${registryrepo}:${env.BUILD_NUMBER}"
}
stages {

    stage('Build') {
    agent { label 'slave1'}
    when { allOf { environment name: 'os_type', value: 'linux'} }  
      steps {
          script {
               build.mavenbuild()

        }
    }
    
  }

    stage('Docker build') {
    agent { label 'slave1'}
    when { allOf { environment name: 'os_type', value: 'linux'} }  
      steps {
          script {
               build.buildDockerTaggedImage1(imageURI)

        }
    }
    
  }
}
} 
